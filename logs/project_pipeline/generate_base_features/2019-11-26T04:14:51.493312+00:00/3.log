[2019-11-26 05:26:51,032] {taskinstance.py:630} INFO - Dependencies all met for <TaskInstance: project_pipeline.generate_base_features 2019-11-26T04:14:51.493312+00:00 [queued]>
[2019-11-26 05:26:51,053] {taskinstance.py:630} INFO - Dependencies all met for <TaskInstance: project_pipeline.generate_base_features 2019-11-26T04:14:51.493312+00:00 [queued]>
[2019-11-26 05:26:51,053] {taskinstance.py:841} INFO - 
--------------------------------------------------------------------------------
[2019-11-26 05:26:51,053] {taskinstance.py:842} INFO - Starting attempt 3 of 3
[2019-11-26 05:26:51,054] {taskinstance.py:843} INFO - 
--------------------------------------------------------------------------------
[2019-11-26 05:26:51,185] {taskinstance.py:862} INFO - Executing <Task(PythonOperator): generate_base_features> on 2019-11-26T04:14:51.493312+00:00
[2019-11-26 05:26:51,185] {base_task_runner.py:133} INFO - Running: ['airflow', 'run', 'project_pipeline', 'generate_base_features', '2019-11-26T04:14:51.493312+00:00', '--job_id', '4', '--pool', 'default_pool', '--raw', '-sd', 'DAGS_FOLDER/project_pipeline.py', '--cfg_path', '/tmp/tmpcdnc2v3e']
[2019-11-26 05:26:52,819] {base_task_runner.py:115} INFO - Job 4: Subtask generate_base_features [2019-11-26 05:26:52,818] {__init__.py:51} INFO - Using executor SequentialExecutor
[2019-11-26 05:26:52,819] {base_task_runner.py:115} INFO - Job 4: Subtask generate_base_features [2019-11-26 05:26:52,819] {dagbag.py:92} INFO - Filling up the DagBag from /home/exceptions/mlprojects/Airflow/sendyproject/dags/project_pipeline.py
[2019-11-26 05:26:53,343] {base_task_runner.py:115} INFO - Job 4: Subtask generate_base_features [2019-11-26 05:26:53,341] {cli.py:545} INFO - Running <TaskInstance: project_pipeline.generate_base_features 2019-11-26T04:14:51.493312+00:00 [running]> on host exceptions
[2019-11-26 05:26:53,383] {python_operator.py:105} INFO - Exporting the following env vars:
AIRFLOW_CTX_EXECUTION_DATE=2019-11-26T04:14:51.493312+00:00
AIRFLOW_CTX_DAG_RUN_ID=manual__2019-11-26T04:14:51.493312+00:00
AIRFLOW_CTX_DAG_ID=project_pipeline
AIRFLOW_CTX_TASK_ID=generate_base_features
[2019-11-26 05:26:53,386] {taskinstance.py:1058} ERROR - File b'../data/raw/df_train.csv' does not exist
Traceback (most recent call last):
  File "/home/exceptions/env/lib/python3.5/site-packages/airflow/models/taskinstance.py", line 930, in _run_raw_task
    result = task_copy.execute(context=context)
  File "/home/exceptions/env/lib/python3.5/site-packages/airflow/operators/python_operator.py", line 113, in execute
    return_value = self.execute_callable()
  File "/home/exceptions/env/lib/python3.5/site-packages/airflow/operators/python_operator.py", line 118, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "./src/feature_engineering.py", line 14, in __init__
    self.read_data()
  File "./src/feature_engineering.py", line 18, in read_data
    self.df = pd.read_csv('../data/raw/df_train.csv', parse_dates=to_parse)
  File "/home/exceptions/env/lib/python3.5/site-packages/pandas/io/parsers.py", line 678, in parser_f
    return _read(filepath_or_buffer, kwds)
  File "/home/exceptions/env/lib/python3.5/site-packages/pandas/io/parsers.py", line 440, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/home/exceptions/env/lib/python3.5/site-packages/pandas/io/parsers.py", line 787, in __init__
    self._make_engine(self.engine)
  File "/home/exceptions/env/lib/python3.5/site-packages/pandas/io/parsers.py", line 1014, in _make_engine
    self._engine = CParserWrapper(self.f, **self.options)
  File "/home/exceptions/env/lib/python3.5/site-packages/pandas/io/parsers.py", line 1708, in __init__
    self._reader = parsers.TextReader(src, **kwds)
  File "pandas/_libs/parsers.pyx", line 384, in pandas._libs.parsers.TextReader.__cinit__
  File "pandas/_libs/parsers.pyx", line 695, in pandas._libs.parsers.TextReader._setup_parser_source
FileNotFoundError: File b'../data/raw/df_train.csv' does not exist
[2019-11-26 05:26:53,388] {taskinstance.py:1087} INFO - All retries failed; marking task as FAILED
[2019-11-26 05:26:53,405] {logging_mixin.py:112} INFO - [2019-11-26 05:26:53,405] {configuration.py:299} WARNING - section/key [smtp/smtp_user] not found in config
[2019-11-26 05:26:53,406] {taskinstance.py:1093} ERROR - Failed to send email to: ['agbokenechukwu.k@gmail.com']
[2019-11-26 05:26:53,406] {taskinstance.py:1094} ERROR - [Errno 111] Connection refused
Traceback (most recent call last):
  File "/home/exceptions/env/lib/python3.5/site-packages/airflow/models/taskinstance.py", line 930, in _run_raw_task
    result = task_copy.execute(context=context)
  File "/home/exceptions/env/lib/python3.5/site-packages/airflow/operators/python_operator.py", line 113, in execute
    return_value = self.execute_callable()
  File "/home/exceptions/env/lib/python3.5/site-packages/airflow/operators/python_operator.py", line 118, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "./src/feature_engineering.py", line 14, in __init__
    self.read_data()
  File "./src/feature_engineering.py", line 18, in read_data
    self.df = pd.read_csv('../data/raw/df_train.csv', parse_dates=to_parse)
  File "/home/exceptions/env/lib/python3.5/site-packages/pandas/io/parsers.py", line 678, in parser_f
    return _read(filepath_or_buffer, kwds)
  File "/home/exceptions/env/lib/python3.5/site-packages/pandas/io/parsers.py", line 440, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/home/exceptions/env/lib/python3.5/site-packages/pandas/io/parsers.py", line 787, in __init__
    self._make_engine(self.engine)
  File "/home/exceptions/env/lib/python3.5/site-packages/pandas/io/parsers.py", line 1014, in _make_engine
    self._engine = CParserWrapper(self.f, **self.options)
  File "/home/exceptions/env/lib/python3.5/site-packages/pandas/io/parsers.py", line 1708, in __init__
    self._reader = parsers.TextReader(src, **kwds)
  File "pandas/_libs/parsers.pyx", line 384, in pandas._libs.parsers.TextReader.__cinit__
  File "pandas/_libs/parsers.pyx", line 695, in pandas._libs.parsers.TextReader._setup_parser_source
FileNotFoundError: File b'../data/raw/df_train.csv' does not exist

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/exceptions/env/lib/python3.5/site-packages/airflow/models/taskinstance.py", line 1091, in handle_failure
    self.email_alert(error)
  File "/home/exceptions/env/lib/python3.5/site-packages/airflow/models/taskinstance.py", line 1305, in email_alert
    send_email(self.task.email, subject, html_content)
  File "/home/exceptions/env/lib/python3.5/site-packages/airflow/utils/email.py", line 55, in send_email
    mime_subtype=mime_subtype, mime_charset=mime_charset, **kwargs)
  File "/home/exceptions/env/lib/python3.5/site-packages/airflow/utils/email.py", line 101, in send_email_smtp
    send_MIME_email(smtp_mail_from, recipients, msg, dryrun)
  File "/home/exceptions/env/lib/python3.5/site-packages/airflow/utils/email.py", line 121, in send_MIME_email
    s = smtplib.SMTP_SSL(SMTP_HOST, SMTP_PORT) if SMTP_SSL else smtplib.SMTP(SMTP_HOST, SMTP_PORT)
  File "/usr/lib/python3.5/smtplib.py", line 251, in __init__
    (code, msg) = self.connect(host, port)
  File "/usr/lib/python3.5/smtplib.py", line 335, in connect
    self.sock = self._get_socket(host, port, self.timeout)
  File "/usr/lib/python3.5/smtplib.py", line 306, in _get_socket
    self.source_address)
  File "/usr/lib/python3.5/socket.py", line 711, in create_connection
    raise err
  File "/usr/lib/python3.5/socket.py", line 702, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused
[2019-11-26 05:26:53,504] {base_task_runner.py:115} INFO - Job 4: Subtask generate_base_features /home/exceptions/env/lib/python3.5/site-packages/airflow/configuration.py:627: DeprecationWarning: You have two airflow.cfg files: /home/exceptions/airflow/airflow.cfg and /home/exceptions/mlprojects/Airflow/sendyproject/airflow.cfg. Airflow used to look at ~/airflow/airflow.cfg, even when AIRFLOW_HOME was set to a different value. Airflow will now only read /home/exceptions/mlprojects/Airflow/sendyproject/airflow.cfg, and you should remove the other file
[2019-11-26 05:26:53,504] {base_task_runner.py:115} INFO - Job 4: Subtask generate_base_features   category=DeprecationWarning,
[2019-11-26 05:26:53,510] {base_task_runner.py:115} INFO - Job 4: Subtask generate_base_features Traceback (most recent call last):
[2019-11-26 05:26:53,511] {base_task_runner.py:115} INFO - Job 4: Subtask generate_base_features   File "/home/exceptions/env/bin/airflow", line 37, in <module>
[2019-11-26 05:26:53,511] {base_task_runner.py:115} INFO - Job 4: Subtask generate_base_features     args.func(args)
[2019-11-26 05:26:53,511] {base_task_runner.py:115} INFO - Job 4: Subtask generate_base_features   File "/home/exceptions/env/lib/python3.5/site-packages/airflow/utils/cli.py", line 74, in wrapper
[2019-11-26 05:26:53,511] {base_task_runner.py:115} INFO - Job 4: Subtask generate_base_features     return f(*args, **kwargs)
[2019-11-26 05:26:53,511] {base_task_runner.py:115} INFO - Job 4: Subtask generate_base_features   File "/home/exceptions/env/lib/python3.5/site-packages/airflow/bin/cli.py", line 551, in run
[2019-11-26 05:26:53,511] {base_task_runner.py:115} INFO - Job 4: Subtask generate_base_features     _run(args, dag, ti)
[2019-11-26 05:26:53,511] {base_task_runner.py:115} INFO - Job 4: Subtask generate_base_features   File "/home/exceptions/env/lib/python3.5/site-packages/airflow/bin/cli.py", line 469, in _run
[2019-11-26 05:26:53,512] {base_task_runner.py:115} INFO - Job 4: Subtask generate_base_features     pool=args.pool,
[2019-11-26 05:26:53,512] {base_task_runner.py:115} INFO - Job 4: Subtask generate_base_features   File "/home/exceptions/env/lib/python3.5/site-packages/airflow/utils/db.py", line 74, in wrapper
[2019-11-26 05:26:53,512] {base_task_runner.py:115} INFO - Job 4: Subtask generate_base_features     return func(*args, **kwargs)
[2019-11-26 05:26:53,512] {base_task_runner.py:115} INFO - Job 4: Subtask generate_base_features   File "/home/exceptions/env/lib/python3.5/site-packages/airflow/models/taskinstance.py", line 930, in _run_raw_task
[2019-11-26 05:26:53,512] {base_task_runner.py:115} INFO - Job 4: Subtask generate_base_features     result = task_copy.execute(context=context)
[2019-11-26 05:26:53,512] {base_task_runner.py:115} INFO - Job 4: Subtask generate_base_features   File "/home/exceptions/env/lib/python3.5/site-packages/airflow/operators/python_operator.py", line 113, in execute
[2019-11-26 05:26:53,512] {base_task_runner.py:115} INFO - Job 4: Subtask generate_base_features     return_value = self.execute_callable()
[2019-11-26 05:26:53,513] {base_task_runner.py:115} INFO - Job 4: Subtask generate_base_features   File "/home/exceptions/env/lib/python3.5/site-packages/airflow/operators/python_operator.py", line 118, in execute_callable
[2019-11-26 05:26:53,513] {base_task_runner.py:115} INFO - Job 4: Subtask generate_base_features     return self.python_callable(*self.op_args, **self.op_kwargs)
[2019-11-26 05:26:53,513] {base_task_runner.py:115} INFO - Job 4: Subtask generate_base_features   File "./src/feature_engineering.py", line 14, in __init__
[2019-11-26 05:26:53,513] {base_task_runner.py:115} INFO - Job 4: Subtask generate_base_features     self.read_data()
[2019-11-26 05:26:53,514] {base_task_runner.py:115} INFO - Job 4: Subtask generate_base_features   File "./src/feature_engineering.py", line 18, in read_data
[2019-11-26 05:26:53,514] {base_task_runner.py:115} INFO - Job 4: Subtask generate_base_features     self.df = pd.read_csv('../data/raw/df_train.csv', parse_dates=to_parse)
[2019-11-26 05:26:53,514] {base_task_runner.py:115} INFO - Job 4: Subtask generate_base_features   File "/home/exceptions/env/lib/python3.5/site-packages/pandas/io/parsers.py", line 678, in parser_f
[2019-11-26 05:26:53,514] {base_task_runner.py:115} INFO - Job 4: Subtask generate_base_features     return _read(filepath_or_buffer, kwds)
[2019-11-26 05:26:53,514] {base_task_runner.py:115} INFO - Job 4: Subtask generate_base_features   File "/home/exceptions/env/lib/python3.5/site-packages/pandas/io/parsers.py", line 440, in _read
[2019-11-26 05:26:53,514] {base_task_runner.py:115} INFO - Job 4: Subtask generate_base_features     parser = TextFileReader(filepath_or_buffer, **kwds)
[2019-11-26 05:26:53,515] {base_task_runner.py:115} INFO - Job 4: Subtask generate_base_features   File "/home/exceptions/env/lib/python3.5/site-packages/pandas/io/parsers.py", line 787, in __init__
[2019-11-26 05:26:53,515] {base_task_runner.py:115} INFO - Job 4: Subtask generate_base_features     self._make_engine(self.engine)
[2019-11-26 05:26:53,515] {base_task_runner.py:115} INFO - Job 4: Subtask generate_base_features   File "/home/exceptions/env/lib/python3.5/site-packages/pandas/io/parsers.py", line 1014, in _make_engine
[2019-11-26 05:26:53,515] {base_task_runner.py:115} INFO - Job 4: Subtask generate_base_features     self._engine = CParserWrapper(self.f, **self.options)
[2019-11-26 05:26:53,515] {base_task_runner.py:115} INFO - Job 4: Subtask generate_base_features   File "/home/exceptions/env/lib/python3.5/site-packages/pandas/io/parsers.py", line 1708, in __init__
[2019-11-26 05:26:53,515] {base_task_runner.py:115} INFO - Job 4: Subtask generate_base_features     self._reader = parsers.TextReader(src, **kwds)
[2019-11-26 05:26:53,515] {base_task_runner.py:115} INFO - Job 4: Subtask generate_base_features   File "pandas/_libs/parsers.pyx", line 384, in pandas._libs.parsers.TextReader.__cinit__
[2019-11-26 05:26:53,516] {base_task_runner.py:115} INFO - Job 4: Subtask generate_base_features   File "pandas/_libs/parsers.pyx", line 695, in pandas._libs.parsers.TextReader._setup_parser_source
[2019-11-26 05:26:53,516] {base_task_runner.py:115} INFO - Job 4: Subtask generate_base_features FileNotFoundError: File b'../data/raw/df_train.csv' does not exist
[2019-11-26 05:26:55,913] {logging_mixin.py:112} INFO - [2019-11-26 05:26:55,912] {local_task_job.py:124} WARNING - Time since last heartbeat(0.04 s) < heartrate(5.0 s), sleeping for 4.959523 s
[2019-11-26 05:27:00,880] {logging_mixin.py:112} INFO - [2019-11-26 05:27:00,878] {local_task_job.py:103} INFO - Task exited with return code 1
